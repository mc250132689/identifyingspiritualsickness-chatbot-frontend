<!DOCTYPE html>
<html>
<head>
  <title>Admin Training Data</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="container">
<h2>Admin Panel - Training Data</h2>

<input id="search" placeholder="Search..." onkeyup="filterData()">

<table id="table" border="1" width="100%" style="margin-top:10px;">
<thead><tr><th>#</th><th>Question</th><th>Answer</th><th>Action</th></tr></thead>
<tbody></tbody>
</table>

</div>

<script>
const API = "https://identifyingspiritualsickness-chatbot.onrender.com";
let records = [];

async function loadData() {
  const r = await fetch(API + "/admin/get-data");
  records = await r.json();
  render(records);
}

function render(data) {
  const tbody = document.querySelector("#table tbody");
  tbody.innerHTML = "";
  data.forEach((item, i) => {
    tbody.innerHTML += `
      <tr>
        <td>${i}</td>
        <td>${item.question}</td>
        <td>${item.answer}</td>
        <td><button onclick="del(${i})">Delete</button></td>
      </tr>`;
  });
}

function filterData() {
  const q = document.getElementById("search").value.toLowerCase();
  const filtered = records.filter(x => x.question.toLowerCase().includes(q));
  render(filtered);
}

async function del(index) {
  await fetch(API + "/admin/delete", {
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({index})
  });
  loadData();
}

loadData();
</script>

</body>
</html>
